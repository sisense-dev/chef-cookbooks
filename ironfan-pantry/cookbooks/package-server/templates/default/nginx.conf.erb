# Generated by Chef

upstream <%= @proxy_name %> {
  server      <%= @server %> fail_timeout=0;
}

server {
  listen      80;
  server_name <%= @server_name %>;
  access_log  <%= node[:package_server][:log_dir] %>/nginx.<%= @proxy_name %>.access.log;
  error_log   <%= node[:package_server][:log_dir] %>/nginx.<%= @proxy_name %>.error.log;

  root        <%= @root %>;

  location / {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect   off;
    proxy_pass       http://<%= @proxy_name %>;
  } 
}